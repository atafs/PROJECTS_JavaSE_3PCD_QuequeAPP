package com.iscte.queque._2concurrency.lock.synchronized_._vSync_2Hash;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.net.Socket;

public class HashSyncMain {
	
	//ATTRIBUTES
	private static int count;
	
	//CONSTANTS
	private static final int MAX = 100;
	private static final int SLEEP = 125;
	
	//THREADS
	private Thread t1;
	private Thread t2;
	
	//CONSTRUCTOR
	public HashSyncMain() {
		this.count = 0;
	}
	
	//GETTER
	public int getCount() {
		return count;
	}

	//MAIN
	public static void main(String[] args) {
		//INSTANTIATE
		HashSyncMain hashSync = new HashSyncMain();
		System.out.println("STARTING THE APP..........................");
		
		//START
		
		//START
		hashSync.t2 = new Thread(new Thread1("Tomas"));	
	
		//JOIN
		try {
			hashSync.t1.join();
			hashSync.t2.join();
		} catch (InterruptedException e) {
			e.printStackTrace();
		}	
		System.out.println("FINISHING THE APP AFTER JOIN THREADS: count = " + count );

	}
	
	//SYNCHRONIZED
	public static synchronized void incount(Thread1 thread1) {
		count++;
		if (thread1.getThreadName().equals("Americo")) {
			System.err.println(thread1.getThreadName() + " => COUNT = " + count);

		} else if (thread1.getThreadName().equals("Tomas")) {
			System.out.println(thread1.getThreadName() + " => COUNT = " + count);
			
			//SLEEP
			sleepIncount();
		}
	}
	
	//METHOD SLEEP
	public static void sleepIncount() {
		//SLEEP
		try {
			Thread.sleep(SLEEP);
		} catch (InterruptedException e) {
			e.printStackTrace();
		}
	}
	
	//INNER CLASS
	private class Thread1 implements Runnable {

		//ATTRIBUTES
		private String threadName;

		//CONSTRUCTOR
		public Thread1(String threadName)  {
			this.threadName = threadName;
		}
		
		//GETTER
		public String getThreadName() {
			return threadName;
		}
		
		//RUN
		@Override
		public void run() {		
			//LOOP
			for (int i = 0; i < MAX; i++) {
				incount(this);
			}
		}
	}
	
	//INNER CLASS
	private class Thread2 implements Runnable {

		//ATTRIBUTES
		private String threadName;

		//CONSTRUCTOR
		public Thread2(String threadName)  {
			this.threadName = threadName;
		}
		
		//GETTER
		public String getThreadName() {
			return threadName;
		}
		
		//RUN
		@Override
		public void run() {		
			//LOOP
			for (int i = 0; i < MAX; i++) {
				incount(this);
			}
		}
	}
}
